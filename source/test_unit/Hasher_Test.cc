#include <gtest/gtest.h>
#include <vector>
#include "Hasher.hpp"

using mylib::security::Hasher;

TEST(HasherTest, HashTest)
{
	std::string plain = "Hello World!";
	Hash_t cipher = {
		0x7F, 0x83, 0xB1, 0x65, 0x7F, 0xF1, 0xFC, 0x53, 
		0xB9, 0x2D, 0xC1, 0x81, 0x48, 0xA1, 0xD6, 0x5D, 
		0xFC, 0x2D, 0x4B, 0x1F, 0xA3, 0xD6, 0x77, 0x28, 
		0x4A, 0xDD, 0xD2, 0x00, 0x12, 0x6D, 0x90, 0x69
	};
	std::vector<unsigned char> plainVec;

	for(auto &ch : plain)
		plainVec.push_back(ch);

	auto hashed = Hasher::sha256(plainVec.data(), plainVec.size());

	ASSERT_EQ(hashed, cipher);
}

